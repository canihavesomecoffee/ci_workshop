{% extends "workshop_step.html" %}

{% block step_content %}
    <h1>{{ current_step }}. Test the pipeline</h1>
    <p class="text-center"><img class="img-fluid" alt="That's it!" src="{{ url_for('static', filename='img/end.gif', _external=True) }}" /></p>
    <p>We now should have set up a full CI pipeline. Whenever you:</p>
    <ul>
        <li>Open a Pull Request</li>
        <li>Commit to master</li>
    </ul>
    <p>Then the tests will be automatically run, a code coverage report will be generated, and if the tests passed the app will be automatically deployed.</p>
    <h2>Add badges</h2>
    <p>Since we have a well-tested application, we want to show off that we did a great job! For this purpose, we can add some shiny badges to our README.</p>
    <p>Navigate to <a href="https://shields.io" target="_blank">shields.io</a>, and grab yourself these badges:</p>
    <ul>
        <li>A build badge for the master branch on Travis</li>
        <li>A code coverage badge for CodeCov</li>
        <li>A badge that shows the amount of open pull requests</li>
        <li>A badge that shows if your own deployed app is online</li>
    </ul>
    <h2>Witness the impact of new untested code</h2>
    <p>We prepared a <a href="https://github.com/canihavesomecoffee/ci_workshop/tree/contactform" target="_blank">branch (contactform)</a> that adds a new page, but did not add unittests to it.</p>
    <p>You should open up a Pull Request on your own repository using this branch, and check out the impact that is reported by the code coverage tool.</p>
    <p>Then you should decide if you want to merge this Pull Request or not...</p>
    <h2>Add new content</h2>
    <p>In this section you will add some new content to the website, to see the impact of new code with unittests on the application and deployment process</p>
    <h3>A random joke page</h3>
    <p>We'd like to see a page added to this site where you can get a random joke selected from a table that contains only <b>good</b> jokes.</p>
    <ul>
        <li>Create a <a href="http://flask-sqlalchemy.pocoo.org/2.3/models/" target="_blank">database model</a> for holding the jokes</li>
        <li>Update the init_db.py file to add some <b>good</b> jokes by default</li>
        <li>Add a <a href="http://flask.pocoo.org/docs/1.0/quickstart/#routing" target="_blank">route</a> for the new page</li>
        <li>Add a template that displays a selected joke</li>
        <li>Add a menu entry for this new page</li>
    </ul>
    <h3>Adding new daily jokes</h3>
    <p>Now that you can display a random, <b>good</b> joke, we also want to be able to add jokes. Every logged-in user should be able to add their own (mediocre) jokes to the list.</p>
    <ul>
        <li>Create a route for the new page</li>
        <li>Add a template for entering a new joke</li>
        <li>Process the form and add the joke to the list</li>
        <li>Add a menu entry</li>
    </ul>
    <h2>What else?</h2>
    <p>In case you want to experiment some further, here are some suggestions for things you can try to out to experience the utility of the pipeline:</p>
    <ul>
        <li>Add more content? :)</li>
        <li>Add some more unittests to improve coverage</li>
        <li>Improve the quality of the unittests</li>
        <li>Add an integration test service and then deploy to a live environment (e.g. PhantomJS on Travis (see <a href="https://docs.travis-ci.com/user/gui-and-headless-browsers/#Using-PhantomJS" target="_blank">Using PhantomJS</a> and <a href="https://docs.travis-ci.com/user/build-stages/deploy-heroku/" target="_blank">Build stages</a>)</li>
        <li>Get Travis to automatically create a draft release of the source code on GitHub (see <a href="https://docs.travis-ci.com/user/deployment/releases" target="_blank">GitHub Releases</a>)</li>
        <li>...</li>
    </ul>
{% endblock %}